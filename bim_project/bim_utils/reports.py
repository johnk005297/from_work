#

import requests
from log import Logs
from urllib3.exceptions import InsecureRequestWarning
from urllib3 import disable_warnings
disable_warnings(InsecureRequestWarning)
import auth
from tools import File
import os
import json

class Reports:

    __logger                      = Logs().f_logger(__name__)
    __start_connection            = Logs().http_connect()
    __check_response              = Logs().http_response()
    __api_Reports_Template        = "api/Reports/Template"
    possible_request_errors:tuple = auth.Auth().possible_request_errors

    def __init__(self):
        pass


    def __getattr__(self, item):
        raise AttributeError('License class has no such attribute: ' + item)


    def display_reports(self, url, token):
        ''' Display a list of existing reports on a screen. '''

        headers = {'accept': '*/*', 'Content-type':'text/plain', 'Authorization': f"Bearer {token}"}
        try:
            self.__logger.info(self.__start_connection(url))
            response = requests.get(url=f"{url}/{self.__api_Reports_Template}", headers=headers, verify=False)
            self.__logger.debug(self.__check_response(url, response.request.method, response.request.path_url, response.status_code))

        except self.possible_request_errors as err:
            self.__logger.error(err)
            return False

        if not response.status_code == 200:
            return False

        print()
        for obj in response.json():
            print(f"{obj['id']}: {obj['name']}")


    def parse_the_document(self):
        pass


    def upload_report(self, url, token):
        ''' Function for uploading report templates. '''

        headers = {'accept': 'text/plain', 'Content-type':'application/json-patch+json', 'Authorization': f"Bearer {token}"}

        report_name = r"\"002\", "
        s_1 = r"{\"name\": " + report_name + r"\"typeName\": \"AnalyticReport\", \"content\": \""
        s_3 = "\""






        # with open('orig', 'r', encoding='utf-8') as file:
        #     data = file.readlines()
        #     with open('boo.txt', 'w', encoding='utf-8') as file2:
        #         for line in data:
        #             file2.write(line)
        #             # print(line.strip().replace("\"", "\\\\\\\""))
        #             # file2.write(line.strip().replace(r"\"", "\\\\\\\\\\\\\\\"").replace("\"", "\\\\\\\""))
        #             # elif "\"" in line:
        #             #     file2.write(line.strip().replace("\"", "\\\\\\\""))

        
        
        # with open('boo.txt', 'r', encoding='utf-8') as file:
        #     data = file.read()
        #     payload:str = s_1 + data + s_3




        payload:str = ""
        

        try: 
            # filename:str = input("Enter the filename with a pattern: ")
            
            # name:str = input("Enter Report name: ") # data which need to be added at the beggining of the payload string

            self.__logger.info(self.__start_connection(url))
            response = requests.post(url=f"{url}/{self.__api_Reports_Template}", headers=headers, data=payload.encode('utf-8'), verify=False)
            self.__logger.debug(self.__check_response(url, response.request.method, response.request.path_url, response.status_code))
            if response.status_code == 201:
                print("Report's template successfully uploaded!")
        except self.possible_request_errors as err:
            self.__logger.error(err)
            return False
        except KeyboardInterrupt:
            print('\nInterrupted by the user.')
            return False




        
    def upload_single_report(self, url, token):
        ''' One time function to upload template. "Отчет по Входному контролю Инвестора" '''

        headers = {'accept': 'text/plain', 'Content-type':'application/json-patch+json', 'Authorization': f"Bearer {token}"}




        payload:str = "{\r\n    \"name\": \"Отчет по Входному контролю Инвестора\",\"typeName\": \"AnalyticReport\", \"content\": \"{\\n  \\\"ReportVersion\\\": \\\"2023.3.1.0\\\",\\n  \\\"ReportGuid\\\": \\\"2cc24742452c44369927f3c0ea64f0e8\\\",\\n  \\\"ReportName\\\": \\\"Report\\\",\\n  \\\"ReportAlias\\\": \\\"Report\\\",\\n  \\\"ReportAuthor\\\": \\\"Павел Игоревич Макаров\\\",\\n  \\\"ReportCreated\\\": \\\"/Date(1692020890000-0700)/\\\",\\n  \\\"ReportChanged\\\": \\\"/Date(1695737025932-0700)/\\\",\\n  \\\"EngineVersion\\\": \\\"EngineV2\\\",\\n  \\\"CalculationMode\\\": \\\"Interpretation\\\",\\n  \\\"ReportUnit\\\": \\\"Inches\\\",\\n  \\\"RequestParameters\\\": true,\\n  \\\"Script\\\": \\\"using System;\\\\r\\\\nusing System.Drawing;\\\\r\\\\nusing System.Windows.Forms;\\\\r\\\\nusing System.Data;\\\\r\\\\nusing Stimulsoft.Controls;\\\\r\\\\nusing Stimulsoft.Base.Drawing;\\\\r\\\\nusing Stimulsoft.Report;\\\\r\\\\nusing Stimulsoft.Report.Dialogs;\\\\r\\\\nusing Stimulsoft.Report.Components;\\\\r\\\\n\\\\r\\\\nnamespace Reports\\\\r\\\\n{\\\\r\\\\n    public class Report : Stimulsoft.Report.StiReport\\\\r\\\\n    {\\\\r\\\\n        public Report()        {\\\\r\\\\n            this.InitializeComponent();\\\\r\\\\n        }\\\\r\\\\n\\\\r\\\\n        #region StiReport Designer generated code - do not modify\\\\r\\\\n\\\\t\\\\t#endregion StiReport Designer generated code - do not modify\\\\r\\\\n    }\\\\r\\\\n}\\\\r\\\\n\\\",\\n  \\\"ReferencedAssemblies\\\": {\\n    \\\"0\\\": \\\"System.Dll\\\",\\n    \\\"1\\\": \\\"System.Drawing.Dll\\\",\\n    \\\"2\\\": \\\"System.Windows.Forms.Dll\\\",\\n    \\\"3\\\": \\\"System.Data.Dll\\\",\\n    \\\"4\\\": \\\"System.Xml.Dll\\\",\\n    \\\"5\\\": \\\"Stimulsoft.Controls.Dll\\\",\\n    \\\"6\\\": \\\"Stimulsoft.Base.Dll\\\",\\n    \\\"7\\\": \\\"Stimulsoft.Report.Dll\\\"\\n  },\\n  \\\"Dictionary\\\": {\\n    \\\"Variables\\\": {\\n      \\\"0\\\": {\\n        \\\"Value\\\": \\\"Today.AddDays(-7)\\\",\\n        \\\"Name\\\": \\\"StartDate\\\",\\n        \\\"Alias\\\": \\\"Начало отчетного периода\\\",\\n        \\\"Type\\\": \\\"System.DateTime\\\",\\n        \\\"InitBy\\\": \\\"Expression\\\",\\n        \\\"Key\\\": \\\"7f373b1b8c004baf8c8be298f3175da3\\\",\\n        \\\"AllowUseAsSqlParameter\\\": true\\n      },\\n      \\\"1\\\": {\\n        \\\"Value\\\": \\\"Today\\\",\\n        \\\"Name\\\": \\\"EndDate\\\",\\n        \\\"Alias\\\": \\\"Конец отчетного периода\\\",\\n        \\\"Type\\\": \\\"System.DateTime\\\",\\n        \\\"InitBy\\\": \\\"Expression\\\",\\n        \\\"Key\\\": \\\"b2643ccf4348425b841347b8498666d1\\\",\\n        \\\"AllowUseAsSqlParameter\\\": true\\n      }\\n    },\\n    \\\"DataSources\\\": {\\n      \\\"0\\\": {\\n        \\\"Ident\\\": \\\"StiPostgreSQLSource\\\",\\n        \\\"Name\\\": \\\"ВК Инвестора\\\",\\n        \\\"Alias\\\": \\\"ВК Инвестора\\\",\\n        \\\"Key\\\": \\\"f7343a1c5cf84887937541d9457768f8\\\",\\n        \\\"Columns\\\": {\\n          \\\"0\\\": {\\n            \\\"Name\\\": \\\"ProjectId\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"ProjectId\\\",\\n            \\\"Alias\\\": \\\"ProjectId\\\",\\n            \\\"Type\\\": \\\"System.Guid\\\",\\n            \\\"Key\\\": \\\"8c07c33fa6f242c8a0bc2591b18c47ae\\\"\\n          },\\n          \\\"1\\\": {\\n            \\\"Name\\\": \\\"Код + Имя Инвестпроекта\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Код + Имя Инвестпроекта\\\",\\n            \\\"Alias\\\": \\\"Код + Имя Инвестпроекта\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"2cf0d939f2eb455bae658f17b2d3f799\\\"\\n          },\\n          \\\"2\\\": {\\n            \\\"Name\\\": \\\"Код Инвестпроекта\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Код Инвестпроекта\\\",\\n            \\\"Alias\\\": \\\"Код Инвестпроекта\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"13c61b8fb75a42368d35409820c4bb77\\\"\\n          },\\n          \\\"3\\\": {\\n            \\\"Name\\\": \\\"Номер этапа проектирования\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Номер этапа проектирования\\\",\\n            \\\"Alias\\\": \\\"Номер этапа проектирования\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"06eda69ea28c4df498a3046f30d7f351\\\"\\n          },\\n          \\\"4\\\": {\\n            \\\"Name\\\": \\\"Версия представления\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Версия представления\\\",\\n            \\\"Alias\\\": \\\"Версия представления\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"d86bb195f7054dc99b512ec2d23855c6\\\"\\n          },\\n          \\\"5\\\": {\\n            \\\"Name\\\": \\\"Наименование Инвестпроекта\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Наименование Инвестпроекта\\\",\\n            \\\"Alias\\\": \\\"Наименование Инвестпроекта\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"28d7a1766528469fa3904f78e0af9ca7\\\"\\n          },\\n          \\\"6\\\": {\\n            \\\"Name\\\": \\\"Наименование Агента/Заказчика\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Наименование Агента/Заказчика\\\",\\n            \\\"Alias\\\": \\\"Наименование Агента/Заказчика\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"e50d7f9a6666485e97b4a774b00daa17\\\"\\n          },\\n          \\\"7\\\": {\\n            \\\"Name\\\": \\\"Генеральный проектировщик ПД\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Генеральный проектировщик ПД\\\",\\n            \\\"Alias\\\": \\\"Генеральный проектировщик ПД\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"38452b7c3bec490f891395b243c8787f\\\"\\n          },\\n          \\\"8\\\": {\\n            \\\"Name\\\": \\\"Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\\",\\n            \\\"Alias\\\": \\\"Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"54d734f81be2493495c069a1ff944c63\\\"\\n          },\\n          \\\"9\\\": {\\n            \\\"Name\\\": \\\"Имя процесса\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Имя процесса\\\",\\n            \\\"Alias\\\": \\\"Имя процесса\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"6c03a9013b2941909503cdee641bbb80\\\"\\n          },\\n          \\\"10\\\": {\\n            \\\"Name\\\": \\\"Id процесса\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Id процесса\\\",\\n            \\\"Alias\\\": \\\"Id процесса\\\",\\n            \\\"Type\\\": \\\"System.Guid\\\",\\n            \\\"Key\\\": \\\"e010cca31b5941a9a42a949c2dc4a254\\\"\\n          },\\n          \\\"11\\\": {\\n            \\\"Name\\\": \\\"Статус документации\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Статус документации\\\",\\n            \\\"Alias\\\": \\\"Статус документации\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"a0445e34c54b4468baf4475d1889fcd8\\\"\\n          },\\n          \\\"12\\\": {\\n            \\\"Name\\\": \\\"Номер итерации\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Номер итерации\\\",\\n            \\\"Alias\\\": \\\"Номер итерации\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"a8292c48e1a24a35a9e2a91177046b25\\\"\\n          },\\n          \\\"13\\\": {\\n            \\\"Name\\\": \\\"Начало ВК Инвестора (факт)\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Начало ВК Инвестора (факт)\\\",\\n            \\\"Alias\\\": \\\"Начало ВК Инвестора (факт)\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"4d7f6e3a251147329411c4562a67bdb7\\\"\\n          },\\n          \\\"14\\\": {\\n            \\\"Name\\\": \\\"Окончание ВК Инвестора (факт)\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Окончание ВК Инвестора (факт)\\\",\\n            \\\"Alias\\\": \\\"Окончание ВК Инвестора (факт)\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"f5c5f8ec79ec4a778528ccb8bd886c66\\\"\\n          },\\n          \\\"15\\\": {\\n            \\\"Name\\\": \\\"Окончание ВК Инвестора (план)\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Окончание ВК Инвестора (план)\\\",\\n            \\\"Alias\\\": \\\"Окончание ВК Инвестора (план)\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"9b1ffdaecb9f4d37b9cb0f2f4e601523\\\"\\n          },\\n          \\\"16\\\": {\\n            \\\"Name\\\": \\\"Оператор / эксперт\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Оператор / эксперт\\\",\\n            \\\"Alias\\\": \\\"Оператор / эксперт\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"dbd2a25e1ac541f7bee18e0bd21bd945\\\"\\n          },\\n          \\\"17\\\": {\\n            \\\"Name\\\": \\\"Количество томов\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Количество томов\\\",\\n            \\\"Alias\\\": \\\"Количество томов\\\",\\n            \\\"Type\\\": \\\"System.Int64\\\",\\n            \\\"Key\\\": \\\"28b99b48c8ab42b08232e63d3b3f8efb\\\"\\n          },\\n          \\\"18\\\": {\\n            \\\"Name\\\": \\\"Риск нарушения\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Риск нарушения\\\",\\n            \\\"Alias\\\": \\\"Риск нарушения\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"9d902f4ff9994b3397d4453b903facb9\\\"\\n          },\\n          \\\"19\\\": {\\n            \\\"Name\\\": \\\"CreatedDate\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"CreatedDate\\\",\\n            \\\"Alias\\\": \\\"CreatedDate\\\",\\n            \\\"Type\\\": \\\"System.DateTime\\\",\\n            \\\"Key\\\": \\\"92845bae08614dd0922450b7a1120d98\\\"\\n          },\\n          \\\"20\\\": {\\n            \\\"Name\\\": \\\"ModifiedDate\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"ModifiedDate\\\",\\n            \\\"Alias\\\": \\\"ModifiedDate\\\",\\n            \\\"Type\\\": \\\"System.DateTime\\\",\\n            \\\"Key\\\": \\\"2d5ff82b6bc34649af9daed8de424513\\\"\\n          },\\n          \\\"21\\\": {\\n            \\\"Name\\\": \\\"Кол-во томов\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Кол-во томов\\\",\\n            \\\"Alias\\\": \\\"Кол-во томов\\\",\\n            \\\"Type\\\": \\\"System.Int64\\\",\\n            \\\"Key\\\": \\\"5c8399cc3dae40c882b7b4aa76f81876\\\"\\n          }\\n        },\\n        \\\"NameInSource\\\": \\\"PostgreSQL\\\",\\n        \\\"SqlCommand\\\": \\\"SELECT distinct on (p.\\\\\\\"Id\\\\\\\", \\\\\\\"Номер этапа проектирования\\\\\\\", \\\\\\\"Версия представления\\\\\\\")\\\\r\\\\n--SELECT distinct \\\\r\\\\n-- Начало объявления столбцов, которые пойдут в конечную выгрузку.  В некоторых случаях при объявлении столбца добавляется подзапрос\\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\" as \\\\\\\"ProjectId\\\\\\\"\\\\r\\\\n\\\\t, p.\\\\\\\"Name\\\\\\\" as \\\\\\\"Код + Имя Инвестпроекта\\\\\\\"\\\\r\\\\n\\\\t, case\\\\r\\\\n\\\\t    WHEN \\\\r\\\\n\\\\t    \\\\tx1.\\\\\\\"Value\\\\\\\" IS NULL \\\\r\\\\n\\\\t    \\\\tAND LEFT(p.\\\\\\\"Name\\\\\\\", 7) ~ E\\'^\\\\\\\\\\\\\\\\d+$\\' /*проверка, что первые 7 символов имени проекта состоят только из цифр*/\\\\r\\\\n\\\\t\\\\tthen left(p.\\\\\\\"Name\\\\\\\", 7) /*если поле в карточке не заполено, то берутся первые 7 символов проекта — обычно это и есть код*/\\\\r\\\\n\\\\t\\\\telse x1.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tend as \\\\\\\"Код Инвестпроекта\\\\\\\"\\\\r\\\\n\\\\r\\\\n\\\\t, x8.\\\\\\\"stageNumber\\\\\\\" as \\\\\\\"Номер этапа проектирования\\\\\\\" /*есть ли смысл выносить свойства папок в отдельный подзапрос?*/\\\\r\\\\n\\\\t, x7.\\\\\\\"Value\\\\\\\" as \\\\\\\"Версия представления\\\\\\\" \\\\r\\\\n\\\\r\\\\n-- \\\\\\\"Наименование Инвестпроекта\\\\\\\"\\\\r\\\\n\\\\t--, x2.\\\\\\\"Value\\\\\\\" as \\\\\\\"Наименование Инвестпроекта\\\\\\\"\\\\r\\\\n\\\\t, case\\\\r\\\\n\\\\t\\\\twhen \\\\r\\\\n\\\\t\\\\t\\\\tx2.\\\\\\\"Value\\\\\\\" IS null\\\\r\\\\n\\\\t\\\\t\\\\tand LEFT(p.\\\\\\\"Name\\\\\\\", 7) ~ E\\'^\\\\\\\\\\\\\\\\d+$\\' /*проверка, что первые 7 символов имени проекта состоят только из цифр*/\\\\r\\\\n\\\\t\\\\tthen substring(p.\\\\\\\"Name\\\\\\\" from 8) /*если поле в карточке не заполено  и первые символы это цифры, то берется имя проекта после цифр*/\\\\r\\\\n\\\\t\\\\twhen\\\\r\\\\n\\\\t\\\\t\\\\tx2.\\\\\\\"Value\\\\\\\" IS null\\\\r\\\\n\\\\t\\\\t\\\\tand LEFT(p.\\\\\\\"Name\\\\\\\", 7) ~ E\\'^\\\\\\\\\\\\\\\\d+$\\' is false /*проверка, что первые 7 символов имени проекта НЕ цифры*/\\\\r\\\\n\\\\t\\\\tthen p.\\\\\\\"Name\\\\\\\" /*если поле в карточке не заполено и первые символы не цифры, то берется имя проекта*/\\\\r\\\\n\\\\t\\\\telse x2.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tend as \\\\\\\"Наименование Инвестпроекта\\\\\\\"\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t, x3.\\\\\\\"Value\\\\\\\" as \\\\\\\"Наименование Агента/Заказчика\\\\\\\"\\\\r\\\\n\\\\t, x4.\\\\\\\"Value\\\\\\\" as \\\\\\\"Генеральный проектировщик ПД\\\\\\\"\\\\r\\\\n\\\\t, x5.\\\\\\\"Value\\\\\\\" as \\\\\\\"Филиал ООО \\\\\\\"\\\\\\\"Газпром инвест\\\\\\\"\\\\\\\"\\\\\\\"\\\\r\\\\n\\\\r\\\\n\\\\t-- Столбец \\\\\\\"Имя процесса\\\\\\\". А также доработка: если процесс относится к вызываемому %Административное согласование%, то его дочерние задачи считаются задачами родительского процесса\\\\r\\\\n\\\\t, case when wf.\\\\\\\"Name\\\\\\\" similar to \\'%(%Административное согласование%)%\\'\\\\r\\\\nthen (select distinct wf1.\\\\\\\"Name\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"WorkFlowExemplars\\\\\\\" wfe1\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tleft join \\\\\\\"WorkFlowExemplars\\\\\\\" wfe2 on wfe1.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\" = wfe2.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tleft join \\\\\\\"WorkFlows\\\\\\\" wf1 ON wf1.\\\\\\\"Id\\\\\\\" = wfe2.\\\\\\\"WorkFlowId\\\\\\\" and not wfe1.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tWHERE wfe1.\\\\\\\"Id\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t)\\\\r\\\\n\\\\t\\\\telse wf.\\\\\\\"Name\\\\\\\" end as \\\\\\\"Имя процесса\\\\\\\"\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t-- Столбец \\\\\\\"Дата создания процесса\\\\\\\". Используется для фильтров\\\\r\\\\n\\\\t, (wfe.\\\\\\\"CreatedDate\\\\\\\" + INTERVAL \\'3 hours\\') as \\\\\\\"CreatedDate\\\\\\\" /*StimulSoft не учитывает таймзону, поэтому ее приходится прибавлять вручную*/\\\\r\\\\n\\\\r\\\\n\\\\t-- Столбец \\\\\\\"Дата обновления процесса\\\\\\\". Используется для фильтров\\\\r\\\\n\\\\t, (wfe.\\\\\\\"ModifiedDate\\\\\\\" + INTERVAL \\'3 hours\\') as \\\\\\\"ModifiedDate\\\\\\\" /*StimulSoft не учитывает таймзону, поэтому ее приходится прибавлять вручную*/\\\\r\\\\n\\\\r\\\\n\\\\r\\\\n\\\\t, wfe.\\\\\\\"Id\\\\\\\" AS \\\\\\\"Id процесса\\\\\\\"\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t-- Статус документации. Требует доработки, чтобы учитывались автоматические процессы, т.е. когда статус null\\\\r\\\\n\\\\t-- Попробовать вытягивать статусы документации из свойств документа, прикрепленного к процессу\\\\r\\\\n/*\\\\t, (select distinct bditmp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimDirectoryItems\\\\\\\" bditmp\\\\r\\\\n\\\\twhere bditmp.\\\\\\\"Id\\\\\\\" = x36.\\\\\\\"Value\\\\\\\") as \\\\\\\"Статус документации\\\\\\\"*/\\\\r\\\\n\\\\r\\\\n-- Подключение столбца \\\\\\\"Статус документации\\\\\\\"\\\\r\\\\n, case \\\\r\\\\nwhen (select bditmp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimDirectoryItems\\\\\\\" bditmp\\\\r\\\\n\\\\t\\\\t\\\\twhere bditmp.\\\\\\\"Id\\\\\\\" = x36.\\\\\\\"Value\\\\\\\") is null\\\\r\\\\nthen (select bditmp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimDirectoryItems\\\\\\\" bditmp\\\\r\\\\n\\\\t\\\\t\\\\twhere bditmp.\\\\\\\"Id\\\\\\\" = x3600.\\\\\\\"Value\\\\\\\")\\\\r\\\\n-- попытка подменять нулевое значение на статус \\\\\\\"Новый\\\\\\\". Возможно, пользователи попросят доработать \\\\r\\\\n/*\\\\twhen (select distinct bditmp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\tfrom \\\\\\\"BimDirectoryItems\\\\\\\" bditmp\\\\r\\\\n\\\\t\\\\t\\\\twhere bditmp.\\\\\\\"Id\\\\\\\" = x3600.\\\\\\\"Value\\\\\\\") is null\\\\r\\\\n\\\\tthen \\'Новый\\'*/\\\\r\\\\n\\\\telse \\\\r\\\\n(select distinct bditmp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimDirectoryItems\\\\\\\" bditmp\\\\r\\\\n\\\\t\\\\t\\\\twhere bditmp.\\\\\\\"Id\\\\\\\" = x36.\\\\\\\"Value\\\\\\\")\\\\t\\\\r\\\\n\\\\tend as \\\\\\\"Статус документации\\\\\\\"\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t, x10.\\\\\\\"Value\\\\\\\" as \\\\\\\"Номер итерации\\\\\\\"\\\\r\\\\n\\\\t, x12.\\\\\\\"CreatedDate\\\\\\\" as \\\\\\\"Начало ВК Инвестора (факт)\\\\\\\"\\\\r\\\\n\\\\t, x13.\\\\\\\"EndDate\\\\\\\" as \\\\\\\"Окончание ВК Инвестора (факт)\\\\\\\"\\\\r\\\\n\\\\t, x9.\\\\\\\"DateTimeValue\\\\\\\" as \\\\\\\"Окончание ВК Инвестора (план)\\\\\\\"\\\\r\\\\n\\\\t, x12.\\\\\\\"UserName\\\\\\\" as \\\\\\\"Оператор / эксперт\\\\\\\"\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t-- Подключение столбца \\\\\\\"Количество томов\\\\\\\"\\\\r\\\\n\\\\t-- подумать как вынести счетчик в отдельный подзапрос (для единообразия)\\\\r\\\\n\\\\t, \\\\r\\\\n(SELECT COUNT(be5.\\\\\\\"Id\\\\\\\")\\\\r\\\\n\\\\tFROM \\\\\\\"WorkFlowExemplars\\\\\\\" wfe5\\\\r\\\\n\\\\t          LEFT JOIN \\\\\\\"Relations\\\\\\\" AS r5 \\\\r\\\\n\\\\t          \\\\tON r5.\\\\\\\"Type\\\\\\\" = 16 \\\\r\\\\n\\\\t          \\\\tAND r5.\\\\\\\"FirstEntityId\\\\\\\" = wfe5.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND r5.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t          LEFT JOIN \\\\\\\"BimExemplars\\\\\\\" AS be5 \\\\r\\\\n\\\\t          \\\\tON be5.\\\\\\\"Id\\\\\\\" = r5.\\\\\\\"SecondEntityId\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND be5.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\nAND be5.\\\\\\\"BimClassId\\\\\\\" = (SELECT \\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"BimClasses\\\\\\\" bc \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tWHERE \\\\\\\"NormalizedName\\\\\\\" = \\'ДОКУМЕНТ ПД\\' \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"BimClassType\\\\\\\" = 0 \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tORDER BY \\\\\\\"VersionDate\\\\\\\" LIMIT 1)\\\\r\\\\n\\\\t          WHERE wfe5.\\\\\\\"Id\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\" AND be.\\\\\\\"Id\\\\\\\" IS NOT NULL\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tGROUP BY wfe.\\\\\\\"Name\\\\\\\")\\\\r\\\\n AS \\\\\\\"Кол-во томов\\\\\\\"\\\\r\\\\n--\\\\t, x8.\\\\\\\"docs_count\\\\\\\" as \\\\\\\"Количество томов\\\\\\\"\\\\r\\\\n\\\\t, null as \\\\\\\"Риск нарушения\\\\\\\"\\\\r\\\\n\\\\r\\\\n\\\\r\\\\n------------------------------------------------------------\\\\r\\\\n----- Окончание объявления столбцов -----\\\\r\\\\n\\\\r\\\\n-- Мастер-таблица — проекты\\\\r\\\\nfrom \\\\\\\"Projects\\\\\\\" as p \\\\r\\\\n\\\\r\\\\n-- Экземпляры процессов по проектам. \\\\r\\\\nJOIN \\\\\\\"WorkFlowExemplars\\\\\\\" AS wfe \\\\r\\\\n    on wfe.\\\\\\\"ProjectId\\\\\\\" = p.\\\\\\\"Id\\\\\\\"\\\\r\\\\n    and not wfe.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n    and wfe.\\\\\\\"Status\\\\\\\" in (1,2)\\\\r\\\\n\\\\r\\\\n/*left JOIN (select \\\\r\\\\n\\\\t\\\\t\\\\t\\\\twfe.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t\\\\t, max(wfe.\\\\\\\"ModifiedDate\\\\\\\") as \\\\\\\"max_ModifiedDate\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\tfrom \\\\\\\"WorkFlowExemplars\\\\\\\" AS wfe\\\\r\\\\n\\\\t\\\\t\\\\tjoin \\\\r\\\\n\\\\t\\\\t\\\\twhere wfe.\\\\\\\"IsDeleted\\\\\\\" is false\\\\r\\\\n\\\\t\\\\t\\\\t    and wfe.\\\\\\\"Status\\\\\\\" in (1,2)\\\\r\\\\n\\\\t\\\\t\\\\t) as wfe_max on wfe_max.\\\\\\\"Id\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\"*/\\\\r\\\\n\\\\r\\\\n-- Оригинальные процессы, к которым относятся экземпляры процессов. Используется для поиска правильного имени процесса и для определения автоматических процессов\\\\r\\\\nJOIN \\\\\\\"WorkFlows\\\\\\\" AS wf \\\\r\\\\n    ON wf.\\\\\\\"Id\\\\\\\" = wfe.\\\\\\\"WorkFlowId\\\\\\\" and not wf.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\r\\\\n-- Подключение таблицы дочерних задач с ограничением, что задача называется \\'Входной контроль ПД Инвестора\\'. \\\\r\\\\n-- Таблица необходима для вывода имени эксперта и для определения, когда ВК Инвестора начался (см. ниже x12)\\\\r\\\\nleft JOIN (select distinct *\\\\r\\\\n\\\\tfrom \\\\\\\"WorkFlowTasks\\\\\\\" as wft\\\\r\\\\n\\\\twhere wft.\\\\\\\"Name\\\\\\\" = \\'Входной контроль ПД Инвестора\\'\\\\r\\\\n\\\\t\\\\t\\\\t)\\\\r\\\\n\\\\t    as wft ON wfe.\\\\\\\"Id\\\\\\\" = wft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\" and not wft.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t    --and wft.\\\\\\\"Name\\\\\\\" = \\'Входной контроль ПД Инвестора\\'\\\\r\\\\n\\\\t    \\\\r\\\\n\\\\r\\\\n-- Подключение свойств дочерних задач: \\\\\\\"Оператор / эксперт\\\\\\\", \\\\\\\"Начало ВК Инвестора (факт)\\\\\\\"\\\\r\\\\n-- не работает без таблицы wft (см. выше)\\\\r\\\\nleft JOIN \\\\r\\\\n(SELECT distinct \\\\r\\\\n\\\\tiu.\\\\\\\"WorkFlowTaskId\\\\\\\" AS \\\\\\\"WorkFlowTaskId\\\\\\\"\\\\r\\\\n\\\\t, string_agg( concat_ws(\\'\\', u1.\\\\\\\"LastName\\\\\\\", \\' \\', left(u1.\\\\\\\"FirstName\\\\\\\",1), \\'. \\' , left(u1.\\\\\\\"MiddleName\\\\\\\",1),\\'.\\'), \\'; \\'\\\\r\\\\n\\\\tORDER BY  iu.\\\\\\\"EndDateTime\\\\\\\" DESC NULLS FIRST, iu.\\\\\\\"StartDateTime\\\\\\\" DESC ) as \\\\\\\"UserName\\\\\\\"\\\\r\\\\n\\\\t    , string_agg(u1.\\\\\\\"Id\\\\\\\"::character varying, \\'; \\'\\\\r\\\\n\\\\t    \\\\t\\\\t\\\\t\\\\tORDER by  iu.\\\\\\\"EndDateTime\\\\\\\" DESC NULLS FIRST, iu.\\\\\\\"StartDateTime\\\\\\\" DESC ) as \\\\\\\"UserId\\\\\\\"\\\\r\\\\n\\\\t\\\\t, wft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\"\\\\r\\\\n--\\\\t\\\\t, to_char(wft.\\\\\\\"CreatedDate\\\\\\\",\\'dd.MM.YYYY HH24:MI\\') as \\\\\\\"CreatedDate\\\\\\\"\\\\r\\\\n\\\\t\\\\t, to_char( (wft.\\\\\\\"CreatedDate\\\\\\\" + INTERVAL \\'3 hours\\'), \\'dd.MM.YYYY HH24:MI\\' ) as \\\\\\\"CreatedDate\\\\\\\" /*StimulSoft не учитывает таймзону, поэтому ее приходится прибавлять вручную*/\\\\r\\\\n\\\\r\\\\n\\\\t\\\\t\\\\r\\\\n\\\\t    FROM \\\\\\\"WorkFlowTasks\\\\\\\" as wft\\\\r\\\\n\\\\t    LEFT JOIN \\\\\\\"IssueUsers\\\\\\\" AS iu\\\\r\\\\n\\\\t    \\\\ton iu.\\\\\\\"WorkFlowTaskId\\\\\\\" = wft.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t    \\\\tand iu.\\\\\\\"IsDeleted\\\\\\\" IS false\\\\r\\\\n\\\\t    LEFT JOIN \\\\\\\"Users\\\\\\\" u1\\\\r\\\\n\\\\t    \\\\tON u1.\\\\\\\"Id\\\\\\\" = iu.\\\\\\\"UserId\\\\\\\"\\\\r\\\\n\\\\t    \\\\tand iu.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t    \\\\r\\\\n\\\\t    WHERE wft.\\\\\\\"Name\\\\\\\" = \\'Входной контроль ПД Инвестора\\'\\\\r\\\\n\\\\t    GROUP BY \\\\r\\\\n\\\\t    \\\\tiu.\\\\\\\"WorkFlowTaskId\\\\\\\",\\\\r\\\\n\\\\t    \\\\twft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\",\\\\r\\\\n\\\\t    \\\\twft.\\\\\\\"CreatedDate\\\\\\\"\\\\r\\\\n\\\\t) \\\\r\\\\n    AS x12 ON x12.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\" =  wfe.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\r\\\\n-- Подключение свойств дочерних задач: \\\\\\\"Окончание ВК Инвестора (факт)\\\\\\\"\\\\r\\\\n    \\\\r\\\\nleft JOIN \\\\r\\\\n(SELECT distinct \\\\r\\\\n\\\\twft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\"\\\\r\\\\n--\\\\t, to_char(wft.\\\\\\\"CreatedDate\\\\\\\",\\'dd.MM.YYYY HH24:MI\\') as \\\\\\\"EndDate\\\\\\\"\\\\r\\\\n\\\\t, to_char( (wft.\\\\\\\"CreatedDate\\\\\\\" + INTERVAL \\'3 hours\\'), \\'dd.MM.YYYY HH24:MI\\' ) as \\\\\\\"EndDate\\\\\\\" /*StimulSoft не учитывает таймзону, поэтому ее приходится прибавлять вручную*/\\\\r\\\\n\\\\r\\\\n\\\\t\\\\t\\\\r\\\\n\\\\tFROM \\\\\\\"WorkFlowTasks\\\\\\\" as wft\\\\r\\\\n\\\\tWHERE wft.\\\\\\\"Name\\\\\\\" in (\\\\r\\\\n\\\\t\\\\t    \\'Отработка замечаний. Подготовить ответы на замечания и при необходимости откорректировать комплект ПД\\'\\\\r\\\\n\\\\t\\\\t    , \\'Входной контроль Инвестора. Принятие решения о допуске к экспертизе по результатам ВК Инвестора\\'\\\\r\\\\n\\\\t    \\\\t\\\\t\\\\t\\\\t\\\\t)\\\\r\\\\n\\\\t    \\\\t\\\\r\\\\n\\\\t    GROUP BY \\\\r\\\\n\\\\t    \\\\twft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\",\\\\r\\\\n\\\\t    \\\\twft.\\\\\\\"CreatedDate\\\\\\\"\\\\r\\\\n\\\\t) \\\\r\\\\n    AS x13 ON x13.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\" =  wfe.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t    \\\\r\\\\n--  ? Подключение таблицы связей: связь объекта и экземпляра процесса\\\\r\\\\n        -- под вопросом нужна ли здесь эта таблица\\\\r\\\\nLEFT JOIN \\\\\\\"Relations\\\\\\\" AS r \\\\r\\\\n    ON r.\\\\\\\"FirstEntityId\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\" \\\\r\\\\n        AND not r.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n        --AND r.\\\\\\\"Type\\\\\\\" = 16\\\\r\\\\n\\\\r\\\\n-- ? Подключение объектов (объекты, папки, документы и т.д.), которые имеют связь с экземплярами процессов\\\\r\\\\n                -- под вопросом нужна ли здесь эта таблица\\\\r\\\\nLEFT JOIN \\\\\\\"BimExemplars\\\\\\\" AS be \\\\r\\\\n    ON be.\\\\\\\"Id\\\\\\\" = r.\\\\\\\"SecondEntityId\\\\\\\" \\\\r\\\\n    and not be.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\r\\\\n-- Подключение столбца из карточки проекта: \\\\\\\"Код Инвестпроекта\\\\\\\"\\\\r\\\\nleft join (select \\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\", \\\\r\\\\n\\\\tpcp.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tFROM \\\\\\\"ProjectClassProperties\\\\\\\" AS pcp  \\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"ProjectClassRelations\\\\\\\" AS pcr\\\\r\\\\n\\\\t\\\\t        ON pcp.\\\\\\\"ProjectClassRelationId\\\\\\\" = pcr.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not pcr.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not pcp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"Projects\\\\\\\" p \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tON p.\\\\\\\"Id\\\\\\\" = pcr.\\\\\\\"ProjectId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not p.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\tJOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t\\\\t        ON bp.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    WHERE bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Код Инвестпроекта\\')\\\\r\\\\n    \\\\t\\\\t) \\\\r\\\\n    AS x1 ON p.\\\\\\\"Id\\\\\\\" = x1.\\\\\\\"Id\\\\\\\"\\\\r\\\\n    \\\\r\\\\n-- Подключение столбца из карточки проекта: \\\\\\\"Наименование Инвестпроекта\\\\\\\"\\\\r\\\\nleft join (select \\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\", \\\\r\\\\n\\\\tpcp.\\\\\\\"Value\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"ProjectClassProperties\\\\\\\" AS pcp  \\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"ProjectClassRelations\\\\\\\" AS pcr\\\\r\\\\n\\\\t\\\\t        ON pcp.\\\\\\\"ProjectClassRelationId\\\\\\\" = pcr.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"Projects\\\\\\\" p \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tON p.\\\\\\\"Id\\\\\\\" = pcr.\\\\\\\"ProjectId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\tJOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t\\\\t        ON bp.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t    WHERE p.\\\\\\\"IsDeleted\\\\\\\" = false and pcp.\\\\\\\"IsDeleted\\\\\\\" = false and pcr.\\\\\\\"IsDeleted\\\\\\\" = false and bp.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t\\\\t    and bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Наименование Инвестпроекта\\')\\\\r\\\\n    \\\\t\\\\t) \\\\r\\\\n    \\\\t\\\\tAS x2 ON p.\\\\\\\"Id\\\\\\\" = x2.\\\\\\\"Id\\\\\\\"\\\\r\\\\n    \\\\r\\\\n--Присоединение столбца из карточки проекта: \\'Наименование Агента/Заказчика\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\", \\\\r\\\\n\\\\tbdi.\\\\\\\"Value\\\\\\\", \\\\r\\\\n\\\\tpcp.\\\\\\\"BimDirectoryItemIds\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"ProjectClassProperties\\\\\\\" AS pcp  \\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"ProjectClassRelations\\\\\\\" AS pcr\\\\r\\\\n\\\\t\\\\t        ON pcp.\\\\\\\"ProjectClassRelationId\\\\\\\" = pcr.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not pcp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not pcr.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"Projects\\\\\\\" p \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tON p.\\\\\\\"Id\\\\\\\" = pcr.\\\\\\\"ProjectId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not p.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimDirectoryItemIds\\\\\\\"[1]\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t\\\\t       ON bp.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t       and not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    and bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Наименование Агента/Заказчика\\')\\\\r\\\\n\\\\t    \\\\t) \\\\r\\\\n\\\\t    \\\\tAS x3 ON p.\\\\\\\"Id\\\\\\\" = x3.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t    \\\\t\\\\r\\\\n--Присоединение столбца из карточки проекта: \\'Генеральный проектировщик ПД\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\", \\\\r\\\\n\\\\tbdi.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tFROM \\\\\\\"ProjectClassProperties\\\\\\\" AS pcp  \\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"ProjectClassRelations\\\\\\\" AS pcr\\\\r\\\\n\\\\t\\\\t        ON pcp.\\\\\\\"ProjectClassRelationId\\\\\\\" = pcr.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not pcp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not pcr.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"Projects\\\\\\\" p \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tON p.\\\\\\\"Id\\\\\\\" = pcr.\\\\\\\"ProjectId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not p.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimDirectoryItemIds\\\\\\\"[1]\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t\\\\t       ON bp.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t       and not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    and bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Генеральный проектировщик ПД\\')\\\\r\\\\n    \\\\t\\\\t) \\\\r\\\\n    AS x4 ON p.\\\\\\\"Id\\\\\\\" = x4.\\\\\\\"Id\\\\\\\"\\\\r\\\\n    \\\\r\\\\n--Присоединение столбца из карточки проекта: \\'Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\tp.\\\\\\\"Id\\\\\\\", \\\\r\\\\n\\\\tbdi.\\\\\\\"Value\\\\\\\", \\\\r\\\\n\\\\tpcp.\\\\\\\"BimDirectoryItemIds\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"ProjectClassProperties\\\\\\\" AS pcp  \\\\r\\\\n\\\\t    JOIN \\\\\\\"ProjectClassRelations\\\\\\\" AS pcr\\\\r\\\\n\\\\t        ON pcp.\\\\\\\"ProjectClassRelationId\\\\\\\" = pcr.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t        and not pcp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t        and not pcr.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t    JOIN \\\\\\\"Projects\\\\\\\" p \\\\r\\\\n\\\\t\\\\t\\\\tON p.\\\\\\\"Id\\\\\\\" = pcr.\\\\\\\"ProjectId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\tand not p.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t    JOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimDirectoryItemIds\\\\\\\"[1]\\\\r\\\\n\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t       ON bp.\\\\\\\"Id\\\\\\\" = pcp.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t       and not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t    and bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\')\\\\r\\\\n    \\\\t\\\\t) \\\\r\\\\n    AS x5 ON p.\\\\\\\"Id\\\\\\\" = x5.\\\\\\\"Id\\\\\\\"\\\\r\\\\n    \\\\r\\\\n-- draft Подключение столбца из свойств папки архива: \\'Номер этапа проектирования\\'\\\\r\\\\n    -- Если в папке \\\\\\\"Этап проектирования\\\\\\\" нет документов или других папок, то она не попадет в конечную выгрузку\\\\r\\\\n/*left join (select \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbec.\\\\\\\"ChildId\\\\\\\",\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbep.\\\\\\\"Value\\\\\\\",\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbe.\\\\\\\"ProjectId\\\\\\\",\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbe.\\\\\\\"GlobalId\\\\\\\" as \\\\\\\"Folder_GlobalId\\\\\\\",\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbe.\\\\\\\"Id\\\\\\\" as \\\\\\\"Folder_Id\\\\\\\"\\\\r\\\\n\\\\t\\\\t    FROM \\\\\\\"BimExemplars\\\\\\\" AS be\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimExemplarProperties\\\\\\\" AS bep\\\\r\\\\n\\\\t\\\\t        ON bep.\\\\\\\"BimExemplarId\\\\\\\" = be.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not be.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bep.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp\\\\r\\\\n\\\\t\\\\t        ON bp.\\\\\\\"Id\\\\\\\" = bep.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    join \\\\\\\"BimExemplarCompositions\\\\\\\" bec\\\\r\\\\n\\\\t\\\\t    \\\\ton bec.\\\\\\\"ParentId\\\\\\\" = be.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t    \\\\tand not bec.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    WHERE \\\\r\\\\n\\\\t    \\\\t\\\\tbp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Номер этапа проектирования\\')\\\\r\\\\n\\\\t    \\\\t\\\\tand be.\\\\\\\"IsDeleted\\\\\\\" is False\\\\r\\\\n\\\\t            AND be.\\\\\\\"BimClassId\\\\\\\" = \\\\r\\\\n\\\\t\\\\t\\\\t        (SELECT \\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t\\\\t        FROM \\\\\\\"BimClasses\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t\\\\t        WHERE \\\\r\\\\n\\\\t\\\\t\\\\t\\\\t        \\\\t\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Этап проектирования\\') \\\\r\\\\n\\\\t\\\\t\\\\t\\\\t        \\\\tand \\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t\\\\t\\\\t                AND \\\\\\\"BimClassType\\\\\\\" = 0 limit 1\\\\r\\\\n\\\\t\\\\t\\\\t        )\\\\r\\\\n\\\\t\\\\t\\\\t--order by \\\\\\\"Folder_GlobalId\\\\\\\"\\\\r\\\\n\\\\t\\\\t   ) \\\\r\\\\n\\\\t\\\\t   AS x6 ON p.\\\\\\\"Id\\\\\\\" = x6.\\\\\\\"ProjectId\\\\\\\"*/\\\\r\\\\n\\\\r\\\\n-- Подключение столбца из экземпляра процесса: \\'Версия представления\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\twfep.\\\\\\\"WorkFlowExemplarId\\\\\\\", \\\\r\\\\n\\\\tbdi.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tfrom \\\\\\\"WorkFlowExemplarProperties\\\\\\\" wfep\\\\r\\\\n\\\\t\\\\t\\\\tJOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = wfep.\\\\\\\"BimDirectoryItemIds\\\\\\\"[1]\\\\r\\\\n\\\\t\\\\t        and not bdi.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not wfep.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\tjoin \\\\\\\"BimProperties\\\\\\\" bp \\\\r\\\\n\\\\t\\\\t\\\\t\\\\ton bp.\\\\\\\"Id\\\\\\\" = wfep.\\\\\\\"BimPropertyId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    \\\\tand bp.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'Версия представления%\\')\\\\r\\\\n\\\\t\\\\t  ) \\\\r\\\\n    \\\\tAS x7 ON wfe.\\\\\\\"Id\\\\\\\" = x7.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\n\\\\r\\\\n/*-- draft Присоединение столбца \\'Версия представления\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\t\\\\t\\\\tbep.\\\\\\\"BimExemplarId\\\\\\\", \\\\r\\\\n\\\\t\\\\t\\\\tbdi.\\\\\\\"Value\\\\\\\"\\\\r\\\\n \\\\tfrom \\\\\\\"BimExemplarProperties\\\\\\\"  bep\\\\r\\\\n \\\\tJOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n        ON bdi.\\\\\\\"Id\\\\\\\" = bep.\\\\\\\"BimDirectoryItemId\\\\\\\"\\\\r\\\\n        and not bdi.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n        and not bep.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n \\\\tjoin \\\\\\\"BimProperties\\\\\\\" bp \\\\r\\\\n\\\\t\\\\ton bp.\\\\\\\"Id\\\\\\\" = bep.\\\\\\\"BimPropertyId\\\\\\\" \\\\r\\\\n\\\\t\\\\tand not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n    \\\\tand bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'ВЕРСИЯ ПРЕДСТАВЛЕНИЯ\\')) \\\\r\\\\n    AS x30 ON be.\\\\\\\"Id\\\\\\\" = x30.\\\\\\\"BimExemplarId\\\\\\\"\\\\r\\\\n     \\\\r\\\\n--Доработка автоматические процессы — \\'Версия представления\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbep.\\\\\\\"BimExemplarId\\\\\\\", \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tbdi.\\\\\\\"Value\\\\\\\", \\\\r\\\\n\\\\t\\\\t\\\\t\\\\twft.\\\\\\\"GlobalId\\\\\\\" \\\\r\\\\n\\\\t\\\\t \\\\tfrom \\\\\\\"BimExemplarProperties\\\\\\\"  bep\\\\r\\\\n\\\\t\\\\t \\\\tJOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = bep.\\\\\\\"BimDirectoryItemId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bdi.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bep.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t \\\\tjoin \\\\\\\"BimProperties\\\\\\\" bp \\\\r\\\\n\\\\t\\\\t\\\\t\\\\ton bp.\\\\\\\"Id\\\\\\\" = bep.\\\\\\\"BimPropertyId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    \\\\tand bp.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'ВЕРСИЯ ПРЕДСТАВЛЕНИЯ\\')\\\\r\\\\n\\\\t\\\\t\\\\tLEFT JOIN \\\\\\\"Relations\\\\\\\" AS r \\\\r\\\\n\\\\t\\\\t\\\\t    ON r.\\\\\\\"SecondEntityId\\\\\\\" = bep.\\\\\\\"BimExemplarId\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t        AND not r.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t        AND r.\\\\\\\"Type\\\\\\\" = 16\\\\r\\\\n\\\\t\\\\t\\\\tJOIN \\\\\\\"WorkFlowExemplars\\\\\\\" AS wfe \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tON r.\\\\\\\"FirstEntityId\\\\\\\" = wfe.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\"  \\\\r\\\\n\\\\t\\\\t\\\\t    and not wfe.\\\\\\\"IsDeleted\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t    and wfe.\\\\\\\"Status\\\\\\\" in (1,2)\\\\r\\\\n\\\\t\\\\t\\\\tJOIN \\\\\\\"WorkFlowTasks\\\\\\\" as wft\\\\r\\\\n\\\\t\\\\t\\\\t    ON wfe.\\\\\\\"Id\\\\\\\" = wft.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\") \\\\r\\\\n\\\\t    AS x3000 ON wft.\\\\\\\"GlobalId\\\\\\\" = x3000.\\\\\\\"GlobalId\\\\\\\"\\\\r\\\\n--Доработка автоматические процессы   */\\\\r\\\\n    \\\\t\\\\r\\\\n-- Подключение столбца из экземпляра процесса: \\'Окончание Входного контроля Инвестора (план)\\'\\\\r\\\\nleft join (select \\\\r\\\\n\\\\twfep.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\n\\\\t--, wfep.\\\\\\\"DateTimeValue\\\\\\\"\\\\r\\\\n\\\\t--, to_char(wfep.\\\\\\\"DateTimeValue\\\\\\\", \\'dd.MM.YYYY\\') as \\\\\\\"DateTimeValue\\\\\\\"\\\\r\\\\n\\\\t, to_char( (wfep.\\\\\\\"DateTimeValue\\\\\\\" + INTERVAL \\'3 hours\\'), \\'dd.MM.YYYY\\' ) as \\\\\\\"DateTimeValue\\\\\\\" /*StimulSoft не учитывает таймзону, поэтому ее приходится прибавлять вручную*/\\\\r\\\\n\\\\tfrom \\\\\\\"WorkFlowExemplarProperties\\\\\\\" wfep\\\\r\\\\n\\\\t\\\\t\\\\t-- если подключить WorflowTasks, то можно отфильтровать по конкретной задаче входного контроля\\\\r\\\\n\\\\t\\\\t\\\\tjoin \\\\\\\"BimProperties\\\\\\\" bp \\\\r\\\\n\\\\t\\\\t\\\\t\\\\ton bp.\\\\\\\"Id\\\\\\\" = wfep.\\\\\\\"BimPropertyId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    \\\\tand bp.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'ПЛАНОВАЯ ДАТА ОКОНЧАНИЯ ЗАДАЧИ\\')\\\\r\\\\n\\\\t\\\\t  ) \\\\r\\\\n    \\\\tAS x9 ON wfe.\\\\\\\"Id\\\\\\\" = x9.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\n\\\\r\\\\n\\\\t\\\\r\\\\n-- Подключение столбца \\'Статус документа\\'— поиск по логам\\\\r\\\\n-- выбор между x36 и x3600 осуществляется в начале скрипта при помощи CASE\\\\r\\\\nleft join \\\\r\\\\n(select\\\\t\\\\r\\\\n\\\\t(array_agg(x35.\\\\\\\"Value\\\\\\\" order by x35.\\\\\\\"CreatedDate\\\\\\\" desc))[1] as \\\\\\\"Value\\\\\\\",\\\\r\\\\n\\\\tx35.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\nfrom (select \\\\r\\\\n\\\\tuuid(wflg.\\\\\\\"Data\\\\\\\"->\\'NewPropertyValue\\'->\\'Properties\\'->0->>\\'BimDirectoryItemId\\')as \\\\\\\"Value\\\\\\\",\\\\r\\\\n\\\\t\\\\tuuid(wflg.\\\\\\\"Data\\\\\\\"->\\'NewPropertyValue\\'->>\\'BimPropertyId\\') as \\\\\\\"BimPropertyId\\\\\\\",\\\\r\\\\n\\\\t\\\\twflg.\\\\\\\"WorkFlowExemplarId\\\\\\\",\\\\r\\\\n\\\\t\\\\twflg.\\\\\\\"CreatedDate\\\\\\\" \\\\r\\\\n\\\\t\\\\tFROM \\\\\\\"WorkFlowProcessLogs\\\\\\\" wflg\\\\t\\\\r\\\\n\\\\t\\\\tWHERE \\\\\\\"Type\\\\\\\"=9) as x35\\\\r\\\\nwhere x35.\\\\\\\"BimPropertyId\\\\\\\" = (select bp.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimProperties\\\\\\\" bp\\\\r\\\\n\\\\twhere bp.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'СТАТУС ДОКУМЕНТА:\\'))\\\\r\\\\n\\\\tgroup by x35.\\\\\\\"WorkFlowExemplarId\\\\\\\")\\\\r\\\\n\\\\tas x36 on wfe.\\\\\\\"Id\\\\\\\" = x36.\\\\\\\"WorkFlowExemplarId\\\\\\\" \\\\r\\\\n\\\\t\\\\r\\\\n--Доработка автоматические процессы — \\'Статус документа\\'— поиск по логам\\\\r\\\\n-- выбор между x36 и x3600 осуществляется в начале скрипта при помощи CASE\\\\r\\\\nleft join \\\\r\\\\n(select\\\\t\\\\r\\\\n\\\\t(array_agg(x35.\\\\\\\"Value\\\\\\\" order by x35.\\\\\\\"CreatedDate\\\\\\\" desc))[1] as \\\\\\\"Value\\\\\\\",\\\\r\\\\n\\\\tx35.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\nfrom (select \\\\r\\\\n\\\\tuuid(wflg.\\\\\\\"Data\\\\\\\"->\\'NewPropertyValue\\'->\\'Properties\\'->0->>\\'BimDirectoryItemId\\')as \\\\\\\"Value\\\\\\\",\\\\r\\\\n\\\\t\\\\tuuid(wflg.\\\\\\\"Data\\\\\\\"->\\'NewPropertyValue\\'->>\\'BimPropertyId\\') as \\\\\\\"BimPropertyId\\\\\\\",\\\\r\\\\n\\\\t\\\\twflg.\\\\\\\"WorkFlowExemplarId\\\\\\\",\\\\r\\\\n\\\\t\\\\twflg.\\\\\\\"CreatedDate\\\\\\\" \\\\r\\\\n\\\\t\\\\tFROM \\\\\\\"WorkFlowProcessLogs\\\\\\\" wflg\\\\t\\\\r\\\\n\\\\t\\\\tWHERE \\\\\\\"Type\\\\\\\"=9) as x35\\\\r\\\\nwhere x35.\\\\\\\"BimPropertyId\\\\\\\" = (select bp.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tfrom \\\\\\\"BimProperties\\\\\\\" bp\\\\r\\\\n\\\\twhere bp.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'СТАТУС ДОКУМЕНТА:\\'))\\\\r\\\\n\\\\tgroup by x35.\\\\\\\"WorkFlowExemplarId\\\\\\\")\\\\r\\\\n\\\\tas x3600 on wfe.\\\\\\\"ParentWorkFlowExemplarId\\\\\\\" = x3600.\\\\\\\"WorkFlowExemplarId\\\\\\\" \\\\r\\\\n--Доработка автоматические процессы\\\\r\\\\n\\\\t\\\\r\\\\n-- Подключение столбца из экземпляра процесса: \\'Номер итерации\\'\\\\r\\\\nleft join \\\\r\\\\n(select \\\\r\\\\n\\\\twfep.\\\\\\\"WorkFlowExemplarId\\\\\\\", \\\\r\\\\n\\\\twfep.\\\\\\\"Value\\\\\\\"\\\\r\\\\n\\\\tfrom \\\\\\\"WorkFlowExemplarProperties\\\\\\\" wfep\\\\r\\\\n/*\\\\t\\\\t\\\\tJOIN \\\\\\\"BimDirectoryItems\\\\\\\" AS bdi\\\\r\\\\n\\\\t\\\\t        ON bdi.\\\\\\\"Id\\\\\\\" = wfep.\\\\\\\"BimDirectoryItemIds\\\\\\\"[1]\\\\r\\\\n\\\\t\\\\t        and not bdi.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not wfep.\\\\\\\"IsDeleted\\\\\\\"*/\\\\r\\\\n\\\\t\\\\t\\\\tjoin \\\\\\\"BimProperties\\\\\\\" bp \\\\r\\\\n\\\\t\\\\t\\\\t\\\\ton bp.\\\\\\\"Id\\\\\\\" = wfep.\\\\\\\"BimPropertyId\\\\\\\" \\\\r\\\\n\\\\t\\\\t\\\\t\\\\tand not bp.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    \\\\tand bp.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'НОМЕР ИТЕРАЦИИ (ЧИСЛО)%\\')\\\\r\\\\n\\\\t)\\\\r\\\\n\\\\tas x10 on wfe.\\\\\\\"Id\\\\\\\" = x10.\\\\\\\"WorkFlowExemplarId\\\\\\\"\\\\r\\\\n                \\\\r\\\\n\\\\r\\\\n-- Подключение столбца \\\\\\\"Номер этапа проектирования\\\\\\\", кол-во томов + связи между процессами и папками \\\\\\\"Этап...\\\\\\\", \\\\\\\"Комплект ПД\\\\\\\" через приндлаженость к документам\\\\r\\\\n-- Подключение столбца из свойств папки архива: \\'Номер этапа проектирования\\', \\\\\\\"Количество томов\\\\\\\"\\\\r\\\\nleft join (SELECT \\\\r\\\\n\\\\twfe.\\\\\\\"Id\\\\\\\" as \\\\\\\"wfe_Id\\\\\\\"\\\\r\\\\n\\\\t, wfe.\\\\\\\"Name\\\\\\\" as \\\\\\\"wfe_Name\\\\\\\"\\\\r\\\\n\\\\t, wfe.\\\\\\\"ProjectId\\\\\\\"\\\\r\\\\n\\\\t, be_docs.\\\\\\\"Title\\\\\\\"\\\\r\\\\n\\\\t--, bep_docsStatus.\\\\\\\"Value\\\\\\\" as \\\\\\\"docsStatus\\\\\\\"\\\\r\\\\n\\\\t--, be1.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t--, be1.\\\\\\\"Title\\\\\\\" \\\\r\\\\n\\\\t, be_stage.\\\\\\\"GlobalId\\\\\\\" as \\\\\\\"Stage_GlobalId\\\\\\\"\\\\r\\\\n\\\\t, be_stage.\\\\\\\"Id\\\\\\\" as \\\\\\\"Stage_Id\\\\\\\"\\\\r\\\\n\\\\t, be_stage.\\\\\\\"Title\\\\\\\" as \\\\\\\"Stage_Title\\\\\\\"\\\\r\\\\n\\\\t, bep_stageNumber.\\\\\\\"Value\\\\\\\" as \\\\\\\"stageNumber\\\\\\\"\\\\r\\\\n\\\\t--, bep_stage.\\\\\\\"Value\\\\\\\" as \\\\\\\"stage_properties\\\\\\\"\\\\r\\\\n\\\\t--, bec.\\\\\\\"ParentId\\\\\\\"\\\\r\\\\n\\\\t, be_set.\\\\\\\"GlobalId\\\\\\\" as \\\\\\\"Set_GlobalId\\\\\\\"\\\\r\\\\n\\\\t, be_set.\\\\\\\"Id\\\\\\\" as \\\\\\\"Set_Id\\\\\\\"\\\\r\\\\n\\\\t, be_set.\\\\\\\"Title\\\\\\\" as \\\\\\\"Set_Title\\\\\\\"\\\\r\\\\n\\\\t--, bep_setIteration.\\\\\\\"Value\\\\\\\" as \\\\\\\"setIteration\\\\\\\"\\\\r\\\\n\\\\t--, COUNT(be_docs.\\\\\\\"Id\\\\\\\") as \\\\\\\"docs_count\\\\\\\"\\\\r\\\\n\\\\t          \\\\r\\\\n\\\\t-- мастер-таблица\\\\r\\\\n\\\\tFROM \\\\\\\"WorkFlowExemplars\\\\\\\" wfe\\\\r\\\\n\\\\r\\\\n\\\\t-- связи документов с процессами\\\\r\\\\n\\\\t           JOIN \\\\\\\"Relations\\\\\\\" AS r \\\\r\\\\n\\\\t          \\\\tON r.\\\\\\\"Type\\\\\\\" = 16 \\\\r\\\\n\\\\t          \\\\tAND r.\\\\\\\"FirstEntityId\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND r.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\r\\\\n\\\\t-- документы ПД в процессах\\\\r\\\\n\\\\t           JOIN \\\\\\\"BimExemplars\\\\\\\" AS be_docs \\\\r\\\\n\\\\t          \\\\tON be_docs.\\\\\\\"Id\\\\\\\" = r.\\\\\\\"SecondEntityId\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND be_docs.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\nAND be_docs.\\\\\\\"BimClassId\\\\\\\" = (SELECT \\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"BimClasses\\\\\\\" bc \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tWHERE \\\\\\\"NormalizedName\\\\\\\" = upper (\\'ДОКУМЕНТ ПД\\') \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"BimClassType\\\\\\\" = 0 \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tORDER BY \\\\\\\"VersionDate\\\\\\\" LIMIT 1)\\\\r\\\\n/*-- добавление статуса документов на случай, если его не будет свойствах экземпляра процесса \\\\r\\\\n\\\\t        JOIN \\\\\\\"BimExemplarProperties\\\\\\\" AS bep_docsStatus\\\\r\\\\n\\\\t\\\\t        ON bep_docsStatus.\\\\\\\"BimExemplarId\\\\\\\" = be_docs.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not bep_docsStatus.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp_docsStatus\\\\r\\\\n\\\\t\\\\t        ON bp_docsStatus.\\\\\\\"Id\\\\\\\" = bep_docsStatus.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bp_docsStatus.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and bp_docsStatus.\\\\\\\"NormalizedName\\\\\\\" like upper(\\'СТАТУС ДОКУМЕНТА:\\')  */\\\\r\\\\n\\\\r\\\\n\\\\t-- связи между документами ПД и папками \\\\\\\"Комплект ПД\\\\\\\"\\\\r\\\\n\\\\t           JOIN \\\\\\\"BimExemplarCompositions\\\\\\\" as bec_docs\\\\r\\\\n\\\\t          \\\\tON bec_docs.\\\\\\\"ChildId\\\\\\\" = be_docs.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND bec_docs.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t          \\\\t--and bec.\\\\\\\"Level\\\\\\\" > 2\\\\r\\\\n\\\\r\\\\n\\\\t-- папки Комплект ПД с документами ПД\\\\r\\\\n\\\\t           JOIN \\\\\\\"BimExemplars\\\\\\\" AS be_set \\\\r\\\\n\\\\t\\\\t          \\\\tON bec_docs.\\\\\\\"ParentId\\\\\\\" = be_set.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t          \\\\tAND be_set.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\nAND be_set.\\\\\\\"BimClassId\\\\\\\" = (SELECT \\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"BimClasses\\\\\\\" bc \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tWHERE \\\\\\\"NormalizedName\\\\\\\" = upper (\\'Комплект ПД\\') \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"BimClassType\\\\\\\" = 0 \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tORDER BY \\\\\\\"VersionDate\\\\\\\" LIMIT 1\\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t)\\\\r\\\\n-- Задел на будущее, чтобы подтягивать свойства из папок Комплект ПД. \\\\r\\\\n-- Сейчас не требуется, т.к. свойства дублируются в экзепляра процессов (номер, номер итерации)\\\\r\\\\n/*-- Добавление свойства \\'Номер итреации\\' из папки с классом \\\\\\\"Комплект ПД\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimExemplarProperties\\\\\\\" AS bep_setIteration\\\\r\\\\n\\\\t\\\\t        ON bep_setIteration.\\\\\\\"BimExemplarId\\\\\\\" = be_set.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not bep_setIteration.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp_setIteration\\\\r\\\\n\\\\t\\\\t        ON bp_setIteration.\\\\\\\"Id\\\\\\\" = bep_setIteration.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bp_setIteration.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and bp_setIteration.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Номер итерации\\') */\\\\r\\\\n\\\\r\\\\n-- связи между папкой Комплект ПД и Этап проектирования\\\\r\\\\n\\\\t           JOIN \\\\\\\"BimExemplarCompositions\\\\\\\" as bec_set\\\\r\\\\n\\\\t          \\\\tON bec_set.\\\\\\\"ChildId\\\\\\\" = be_set.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND bec_set.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t          \\\\t--and bec.\\\\\\\"Level\\\\\\\" > 2\\\\r\\\\n\\\\t\\\\t        \\\\r\\\\n-- папки Этап проектирования, в которых вложены папки Комплект ПД\\\\r\\\\n\\\\t           JOIN \\\\\\\"BimExemplars\\\\\\\" AS be_stage \\\\r\\\\n\\\\t\\\\t          \\\\tON bec_set.\\\\\\\"ParentId\\\\\\\" = be_stage.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t          \\\\tAND be_stage.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\nAND be_stage.\\\\\\\"BimClassId\\\\\\\" = (SELECT \\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"BimClasses\\\\\\\" bc \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tWHERE \\\\\\\"NormalizedName\\\\\\\" = upper (\\'ЭТАП ПРОЕКТИРОВАНИЯ\\') \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"BimClassType\\\\\\\" = 0 \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tORDER BY \\\\\\\"VersionDate\\\\\\\" LIMIT 1\\\\r\\\\n\\\\t\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t)\\\\r\\\\n-- Добавление свойства \\'Номер этапа проектирования\\' из папки \\\\\\\"Этап проектирования\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimExemplarProperties\\\\\\\" AS bep_stageNumber\\\\r\\\\n\\\\t\\\\t        ON bep_stageNumber.\\\\\\\"BimExemplarId\\\\\\\" = be_stage.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t\\\\t        and not bep_stageNumber.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t    JOIN \\\\\\\"BimProperties\\\\\\\" AS bp_stageNumber\\\\r\\\\n\\\\t\\\\t        ON bp_stageNumber.\\\\\\\"Id\\\\\\\" = bep_stageNumber.\\\\\\\"BimPropertyId\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and not bp_stageNumber.\\\\\\\"IsDeleted\\\\\\\"\\\\r\\\\n\\\\t\\\\t        and bp_stageNumber.\\\\\\\"NormalizedName\\\\\\\" = upper(\\'Номер этапа проектирования\\') \\\\r\\\\n\\\\t\\\\t        \\\\r\\\\n-- фильтры таблицы x8\\\\r\\\\n\\\\t\\\\t        WHERE \\\\r\\\\n\\\\t\\\\t         wfe.\\\\\\\"Status\\\\\\\" in (1,2)\\\\r\\\\n\\\\t             and be_docs.\\\\\\\"Id\\\\\\\" IS NOT null \\\\r\\\\n\\\\t\\\\t         and be_stage.\\\\\\\"Id\\\\\\\" IS NOT null\\\\r\\\\n\\\\t\\\\t         and be_set.\\\\\\\"Id\\\\\\\" IS NOT null\\\\r\\\\n\\\\t\\\\t         -- фильтр для тестирования: выгружает все процессы и документы, которые в них встречались, а также родительские папки \\\\\\\"Этап проектирования\\\\r\\\\n\\\\t\\\\t         -- and bec.\\\\\\\"ParentId\\\\\\\" = \\'a5f0ee90-abf7-4e08-ab1c-3086d252816b\\'\\\\r\\\\n\\\\t          \\\\r\\\\n\\\\t\\\\t         )\\\\r\\\\n\\\\t\\\\t\\\\tas x8 on x8.\\\\\\\"wfe_Id\\\\\\\" = wfe.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\r\\\\n-- фильтры результирующей выгрузки\\\\r\\\\nwhere \\\\r\\\\n\\\\tp.\\\\\\\"IsDeleted\\\\\\\" is false\\\\r\\\\n\\\\tand wfe.\\\\\\\"IsDeleted\\\\\\\" is false\\\\r\\\\n\\\\t--and p.\\\\\\\"Id\\\\\\\" = x6.\\\\\\\"ProjectId\\\\\\\"\\\\r\\\\n\\\\t--and x8.\\\\\\\"FolderStage_Id\\\\\\\" is not null\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t-- фильтр по процессу \\\\\\\"35. Входной контроль ПД  Инвестора [35]\\\\\\\"\\\\r\\\\n\\\\tand wfe.\\\\\\\"Name\\\\\\\" like \\'%35%Входной контроль%\\'\\\\r\\\\n\\\\t\\\\r\\\\n\\\\t-- фильтр для тестирования по конкретному проекту\\\\r\\\\n\\\\t--and p.\\\\\\\"Id\\\\\\\" = \\'2b0b3b4c-f1e5-4ae8-af6f-29b876f53c0a\\'\\\\r\\\\n\\\\r\\\\norder by p.\\\\\\\"Id\\\\\\\", \\\\\\\"Номер этапа проектирования\\\\\\\", \\\\\\\"Версия представления\\\\\\\"\\\",\\n        \\\"Parameters\\\": {\\n          \\\"0\\\": {\\n            \\\"Name\\\": \\\"Parameter\\\",\\n            \\\"Expression\\\": \\\"StartDate\\\",\\n            \\\"Type\\\": 7\\n          }\\n        }\\n      },\\n      \\\"1\\\": {\\n        \\\"Ident\\\": \\\"StiPostgreSQLSource\\\",\\n        \\\"Name\\\": \\\"Кол-во томов\\\",\\n        \\\"Alias\\\": \\\"Кол-во томов\\\",\\n        \\\"Key\\\": \\\"33c0e65ebb1e4dd7afc72e066c8194ea\\\",\\n        \\\"Columns\\\": {\\n          \\\"0\\\": {\\n            \\\"Name\\\": \\\"Кол-во томов\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"Кол-во томов\\\",\\n            \\\"Alias\\\": \\\"Кол-во томов\\\",\\n            \\\"Type\\\": \\\"System.Int64\\\",\\n            \\\"Key\\\": \\\"5d73b42848214611bf8e30fbe2dacdf9\\\"\\n          },\\n          \\\"1\\\": {\\n            \\\"Name\\\": \\\"wfe5_id\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"wfe5_id\\\",\\n            \\\"Alias\\\": \\\"wfe5_id\\\",\\n            \\\"Type\\\": \\\"System.Guid\\\",\\n            \\\"Key\\\": \\\"c5b8f795572040e698e705b4293dd48f\\\"\\n          },\\n          \\\"2\\\": {\\n            \\\"Name\\\": \\\"wfe_name\\\",\\n            \\\"Index\\\": -1,\\n            \\\"NameInSource\\\": \\\"wfe_name\\\",\\n            \\\"Alias\\\": \\\"wfe_name\\\",\\n            \\\"Type\\\": \\\"System.String\\\",\\n            \\\"Key\\\": \\\"c38114e2d3274be3b7fe96dc3af2d90f\\\"\\n          }\\n        },\\n        \\\"NameInSource\\\": \\\"PostgreSQL\\\",\\n        \\\"SqlCommand\\\": \\\"SELECT \\\\r\\\\n\\\\tCOUNT(be5.\\\\\\\"Id\\\\\\\") as \\\\\\\"Кол-во томов\\\\\\\"\\\\r\\\\n\\\\t, wfe5.\\\\\\\"Id\\\\\\\" as \\\\\\\"wfe5_id\\\\\\\"\\\\r\\\\n\\\\t, wfe5.\\\\\\\"Name\\\\\\\" as \\\\\\\"wfe_name\\\\\\\"\\\\r\\\\n\\\\tFROM \\\\\\\"WorkFlowExemplars\\\\\\\" wfe5\\\\r\\\\n\\\\t        \\\\r\\\\n\\\\t\\\\t\\\\tLEFT JOIN \\\\\\\"Relations\\\\\\\" AS r5 \\\\r\\\\n\\\\t          \\\\tON r5.\\\\\\\"Type\\\\\\\" = 16 \\\\r\\\\n\\\\t          \\\\tAND r5.\\\\\\\"FirstEntityId\\\\\\\" = wfe5.\\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND r5.\\\\\\\"IsDeleted\\\\\\\" = false\\\\r\\\\n\\\\t          LEFT JOIN \\\\\\\"BimExemplars\\\\\\\" AS be5 \\\\r\\\\n\\\\t          \\\\tON be5.\\\\\\\"Id\\\\\\\" = r5.\\\\\\\"SecondEntityId\\\\\\\" \\\\r\\\\n\\\\t          \\\\tAND be5.\\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\nAND be5.\\\\\\\"BimClassId\\\\\\\" = (SELECT \\\\\\\"Id\\\\\\\" \\\\r\\\\n\\\\tFROM \\\\\\\"BimClasses\\\\\\\" bc \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tWHERE \\\\\\\"NormalizedName\\\\\\\" = \\'ДОКУМЕНТ ПД\\' \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"BimClassType\\\\\\\" = 0 \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tAND \\\\\\\"IsDeleted\\\\\\\" = false \\\\r\\\\n\\\\t          \\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\tORDER BY \\\\\\\"VersionDate\\\\\\\" LIMIT 1)\\\\r\\\\n\\\\t          WHERE be5.\\\\\\\"Id\\\\\\\" IS NOT NULL\\\\r\\\\n\\\\t\\\\t\\\\t\\\\tGROUP BY\\\\r\\\\n\\\\t\\\\t\\\\t\\\\t\\\\twfe5.\\\\\\\"Id\\\\\\\"\\\\r\\\\n\\\\t\\\\t\\\\t\\\\t\\\\t , wfe5.\\\\\\\"Name\\\\\\\"\\\\r\\\\n\\\"\\n      }\\n    },\\n    \\\"Databases\\\": {\\n      \\\"0\\\": {\\n        \\\"Ident\\\": \\\"StiPostgreSQLDatabase\\\",\\n        \\\"Name\\\": \\\"PostgreSQL\\\",\\n        \\\"Alias\\\": \\\"PostgreSQL\\\",\\n        \\\"Key\\\": \\\"3c51279be38c47b6a3932503b9137edd\\\",\\n        \\\"ConnectionStringEncrypted\\\": \\\"41zZ60ZKWsHiX9XMZVyoH9V2ZUhhUVrIy0yx3GFx4SPDVNEJS1WTpONNub3qdHUPw6b3As0Y+91rW82Z6Rx3/8Rs9aFGBXuBbB2lhOpxYi/AxNnCSwox2eJPTYTqBKAe1XbbKw==\\\"\\n      }\\n    },\\n    \\\"Relations\\\": {\\n      \\\"0\\\": {\\n        \\\"Name\\\": \\\"Кол-во томов в процессах\\\",\\n        \\\"ChildColumns\\\": {\\n          \\\"0\\\": \\\"Id процесса\\\"\\n        },\\n        \\\"ParentColumns\\\": {\\n          \\\"0\\\": \\\"wfe5_id\\\"\\n        },\\n        \\\"NameInSource\\\": \\\"Связь\\\",\\n        \\\"Alias\\\": \\\"Кол-во томов в процессах\\\",\\n        \\\"Key\\\": \\\"81c1e37baa3f45b399e5a4488693501a\\\",\\n        \\\"ParentSource\\\": \\\"Кол-во томов\\\",\\n        \\\"ChildSource\\\": \\\"ВК Инвестора\\\"\\n      }\\n    }\\n  },\\n  \\\"Pages\\\": {\\n    \\\"0\\\": {\\n      \\\"Ident\\\": \\\"StiPage\\\",\\n      \\\"Name\\\": \\\"Page1\\\",\\n      \\\"Guid\\\": \\\"102bfbf707e74aad98ce3f3bfbc7e2cb\\\",\\n      \\\"Interaction\\\": {\\n        \\\"Ident\\\": \\\"StiInteraction\\\"\\n      },\\n      \\\"Border\\\": \\\";;2;;;;;solid:Black\\\",\\n      \\\"Brush\\\": \\\"solid:\\\",\\n      \\\"Components\\\": {\\n        \\\"0\\\": {\\n          \\\"Ident\\\": \\\"StiPageHeaderBand\\\",\\n          \\\"Name\\\": \\\"PageHeaderBand1\\\",\\n          \\\"ClientRectangle\\\": \\\"0,0.2,18.92,2\\\",\\n          \\\"Interaction\\\": {\\n            \\\"Ident\\\": \\\"StiInteraction\\\"\\n          },\\n          \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n          \\\"Brush\\\": \\\"solid:\\\",\\n          \\\"Components\\\": {\\n            \\\"0\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text36\\\",\\n              \\\"ClientRectangle\\\": \\\"0,0,6.69,0.24\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Отчет по Входному контролю Инвестора за период с {Format(\\\\\\\"{0:dd.MM.yyyy}\\\\\\\", StartDate)} по {Format(\\\\\\\"{0:dd.MM.yyyy}\\\\\\\", EndDate)}\\\"\\n              },\\n              \\\"Font\\\": \\\"Microsoft Sans Serif;;;\\\",\\n              \\\"Border\\\": \\\";127,127,127;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"1\\\": {\\n              \\\"Ident\\\": \\\"StiImage\\\",\\n              \\\"Name\\\": \\\"Image1\\\",\\n              \\\"ClientRectangle\\\": \\\"0,0.24,4.39,1.37\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";127,127,127;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"Margins\\\": {\\n                \\\"Left\\\": 50.0,\\n                \\\"Right\\\": 0.0,\\n                \\\"Top\\\": 0.0,\\n                \\\"Bottom\\\": 0.0\\n              },\\n              \\\"ImageBytes\\\": \\\"iVBORw0KGgoAAAANSUhEUgAAAPAAAAB0CAMAAACMqk9uAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGBQTFRFlsjm6PP62Or2VabWdbbfB33DE4PG/P3+yeLytdfuh7/jp9Dq9vr9fLrgRp3TMpPOwd7wIYvKabDbYazaPJjRoM3pK5DNu9vv4O/4W6TgAYC/7vb7rdX4r9TrAHnC////DO0IHQAACmlJREFUeNrknImWq6oShnEAjXGeu73i+7/lYVRQnHrYd2Fz1tmrYxL1E4qq+ikCpi+10ZksbeBL33JR+aeA4w8Mu78E/IIY1/HfAR5STFrzd4AbjEkXZ85fAR4KjBPyf/RXgCNiwMEbY9T/DWCnwBBMQ0a6+W8AJ6SDHWbIyPkLwEOLIbVex9Iuvg0MIC5YzwKMi+H5wNQH87CybzEGzwfOIYYu//MD4jR+OnDgY5yKv0OEUf50YOKT8ChfpDZOWzeBX6ozGrmDejRwJaYsZrsDwjB/NnCAMH7RP7yQ/ltaGFDfAw4hbmkE3aFUDHAvfjRwxEd07GFIu9gt7Asv7wGnGL5pz5KRXXFwnD8ZmGTCBY06iDPmfwD7jPgWcI5IJkyccUslHkraESN+MjBJHOhIflNeFlYSIy6eDFyydCFgGh4TauPUOt3jFrCHEaHsIQPGfkAfAXw9F3iomRcCnBe3A/NT4LnAxGJbnjPwFjKhp3wuMMkHSYDVIwns05DrM30u8AvS7gRQArcB7fTsucBv5nwrPDeXSnpt/FhgQBeUqCAtG5iCGhf9k4FHGm3NjURZNY8xnwkc0Xw/WnhxEZMpG4WPA+7DbmxctuYQTiVcgJE7fdgm5B0DB867TNsCIUjTQgLsBqnSw3AkU9hzgIcwyuDcnwK4V+YsOmmXjwF2gdqXDJiYr+si9WBFgR9hwyFd8TYA95120KND+gHATrnGZcDELbmjdrAmwPb74QBscRkwyRTyRjuYxR5LmqwGdlOMzcCkd99AO1g4qfWx9LvAe8AdwiDRgcP0s7YaOPYx3gUOC5yI94WRo7HGHzYDDx4+ACY+uCp5z/Y8wkRRZtsCogbspPgImERZKU8OSyFsIdLTjb3ATo0PgakPYkMA/o8tOhBgD8HQWuDhiJcBRxixMZDxsiUCnEEU2woce/gMeIQY8RHNBC4CjLBlk7QCXOJT4L6QSscy/ktbgRt4DjxxSBY9B0LbGi0FDgt8ATiZFfhJSB+wtxN4SPEV4JxH0HxI8PTB0gqABl8CDpDQ7ia+D8DCuiUO3BfXgCePp/2stxl8Zyewjy8Cv5eJmVl9Zmedlq7bHAGzhSUF2J+sBL7QwQKYOSNvBoajlcA9ugzMxnQ623A9WAkc4evAtEqauyUSZ9pYEk+A4/oGMB3+vBAesJUHG4Ff6A4wrZIOBbk3WQl8ZcpagKcPDBuRXIVWAp9HlTowGRDUL7kFTicrgU/TBoiK2vOW3vRYAP2yr8xSAL8PaT9bD4SB9pUcoo46ZC+2Ezg5wq0jw0RcEnfkIGTnlmlwpOwUwBgqu6hwGlwFdgI72S5vtZcZRBgUKJzsBN6NK9H+WjnVs+zcPUyA3T3eo7ygg7b+BMAEwh3e4yLZyNIBTYBzs+99Tw9tYDQCfz+x/7/N4YHpBpYXwBh3GPLct3/Q2ADv9GN0jDiJcmDx20EO5BvRKHXeMNmcdthcOGoUW4o702mWzy4QYD44gpfJgA1B4+FCjEk3oalUqJf8iNZr52qF9RiEUxb0rEJ9lEgOVztNJibZpURh2SboLNFzZbThMvgK8Cpko3zd+gmwjlkhCJ3oDc3Amwv7wewbDb2k1GTMC7nh4npL0yxtjCm+BKzZiywG2XRlOtwCFhu2t6cJVsCzHgM+FWCDHzamfTeAIfuv0q9OAtVg50x8iXkGhifA/GrxJquFzgp4Dn59qAA7m0gLNt8D9gBrZIQF/FCRiZIfPmPJWNZL5KVHFbgGc9mUBuxH8jDf0CtfVfNpuhWw3NwcKDXtJdgug6Phe8DL8xJXSnkFrlDA4lZ0uDuv0DYqMPGImQk4nAcxmwwGNJcwl6pGAbRiX27tqQocV5dG9A1gZY2dX8njQ0r8BJcjgNt+lkuBClxOsRG4m+d8ZqwDnDcTaRdWrUhM026hAm9F2uQA+PMWsNgu4PF9IcJUFODkZ4D9PWBxJ6ojIsAbRzzuAsO2rkqvLi4D82FXCZZIB3bnb0S/BCzca6MDu+v7D3eAYfXms4AL6mvAYtOe3yElXv2HPcx/ZiTwdeCN5GFe0/cyJX9yALwCLO4wEYt13l4P/xYwn341B0aAN0Zs1jkaXdx6FReAhbVEYminez38W0Oan8ApVsAhugK81QDOgYE8wK9QM5OK3ZA1N/71HuaOSgutKPA6PL9YphLBU+BEulkOvFk9T0x++CeB2awxboDBlUlr09SIZQe4lM+5kKHGWu/l7fULwPVsRPS+YK0CD/o8fbVaVJm4doDFVvKXCJ3WWWe8WPPPA/tIhu8eSypV4NW0dVXtUCphdoBnzlTNAykqSKLIF1wQTL8BXMvgkt4memvAegJxuaa/PgNGomxe3vQ8dpbdT6jIxNGfBi7FI3boB7OXBqx38eWfMahOgMVzXLKEaAMM00Qa9k8DAxEms3oybwU8rPabXWv+CbDL7ynr5SdnY5G+mC5N1lF8E5hnSyfACVNbPkRnRitgVrCx5JEXFcfyBJjX6lFFMFqpWk5aFAXUH/A5cKLmw6fAzP1mAf/+2K2A1X3fl3+pwjsBbuaIVtzFvMAaxEM8DHKaL8IrwHUK1QucArMAi5gTO5m7Ae7bjTp01uKzWTqa8+tRlyDWT2y8ArxShE6BWWUD6thdwmEDrIWK19YdujM/XM4ml6sOdxtpgVvAZXwJOGCXByxxyeItsL71u781Se8Ai1stvLTWNZdvAZdcgTqdpTlQ8uaTx2sLrAnp3vmgVn8MwAy8rf+iodZQpayVzj3guvI8r4xk/cU5MLMjvtEqMgKr4h4ZESe8qg7+OZqAg3YD/FKyteKu4qHf0TlwziKOjEfzJmB9X9qJM1a1P5hMJmDHuCf3G4rHTWCXXohtcYe5GXgayqt9rD4bEQtvgGU9VF2WFVqe4tcVj5vASwEaGUxmYF3+qfaVgFAZz6iZzMBCyaJTvkTwv6V43AReZlXiDneApwAoU1HWmTs5bpQPtfm0AywIaC2BlJWq+B/28LL2Q6bgPWAy+aphdelukeNOVUi8ftoDBsvSnBQK0/gf2vAibPjTAfDkqD9NAsuXPrDdt6eW6UXBtAucLM5XOgC64+mngWNdKVKAO7Sc/wCYfFATueoS5H3M1LdXVGmu5iPcDSOWwIStoYlOoD+4JnFQM3u291eABQ3q3FqNUBVgqbjT3OAQeBqA7kJR0WZZ1ha6vJmuTHwN7M2rXUsY1yvxCCrwPU1Lt6xsc5pwBSzXKWlycgzMkI/3IqK6i6fpCFhOVK16G+Fk2NXJI86bwMFmEZBv7FWAp1ok5MM5MLnf0dutK4ZtaZA2V8CyppEpRm9l1OXrR8kXrm8C68L4UgqhApef8wLAOTBbQ6rqbT+j1G+MK8grYGlBqbIGYayNaN3pK8Dx6jRC9VaBwSIYXAKm3ZQ3SZUVCIpC8TJ6h8OJ4iMXKaEiyOSqIhq8ledYlK5e+lHN8q1exbNRJWKgnsZ3pg1wvsQ141zFcyHRd/reJa3v++Eo3Oz5EkoorjyIl+yuY/FCeO3BdXPxriNPOcwfCeSbsXpaw3NWTzN3kXKleLmh+ez/CTAAFdhIv03rV10AAAAASUVORK5CYII=\\\"\\n            },\\n            \\\"2\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text38\\\",\\n              \\\"ClientRectangle\\\": \\\"3.1,0.4,6.69,0.24\\\",\\n              \\\"Enabled\\\": false,\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Отчет по Входному контролю Инвестора от {Format(\\\\\\\"{0:dd.MM.yyyy}\\\\\\\", Today)}\\\"\\n              },\\n              \\\"Font\\\": \\\"Microsoft Sans Serif;;;\\\",\\n              \\\"Border\\\": \\\";127,127,127;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"3\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text37\\\",\\n              \\\"ClientRectangle\\\": \\\"3.2,0.9,4.39,0.64\\\",\\n              \\\"Enabled\\\": false,\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Из мастер DataBand удалены фильтры StartDate и EndDate. Их следует вернуть, когда в StimulSoftViewer появится возможность вводить значения в переменные\\\\r\\\\n\\\\r\\\\nupd. Сделал костыль — добавил в фильтр датабэнда, что к EndDate прибавляется 1 день\\\"\\n              },\\n              \\\"Font\\\": \\\"Microsoft Sans Serif;;;\\\",\\n              \\\"Border\\\": \\\";127,127,127;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            }\\n          }\\n        },\\n        \\\"1\\\": {\\n          \\\"Ident\\\": \\\"StiHeaderBand\\\",\\n          \\\"Name\\\": \\\"HeaderВК_Инвестора\\\",\\n          \\\"ClientRectangle\\\": \\\"0,2.6,18.92,0.3\\\",\\n          \\\"Interaction\\\": {\\n            \\\"Ident\\\": \\\"StiInteraction\\\"\\n          },\\n          \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n          \\\"Brush\\\": \\\"solid:\\\",\\n          \\\"Components\\\": {\\n            \\\"0\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text4\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"0.3,0,0.9,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Код Инвестпроекта\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"1\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text5\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"1.2,0,0.4,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Этап ПД\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"2\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text6\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"1.6,0,1.5,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Наименование Агента/Заказчика\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"3\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text7\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"5.9,0,1.5,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Наименование Агента/Заказчика\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"4\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text9\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"7.4,0,1.5,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Генеральный проектировщик ПД\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"5\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text11\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"8.9,0,1.3,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Филиал ООО \\\\\\\"Газпром инвест\\\\\\\"\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"6\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text13\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"3.1,0,0.9,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Версия представления\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"7\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text16\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"0,0,0.3,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"№ п/п\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"8\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text17\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"4,0,1.9,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Наименование Инвестпроекта\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"9\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text20\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"10.2,0,1.4,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Статус документации\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"10\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text22\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"11.6,0,0.6,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Номер итерации\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"11\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text24\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"12.2,0,1.1,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Начало ВК Инвестора (факт)\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"12\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text26\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"13.3,0,2.2,0.2\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Окончание ВК Инвестора\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"13\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text28\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"13.3,0.2,1.1,0.1\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"План\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"14\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text29\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"14.4,0.2,1.1,0.1\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Факт\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"15\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text31\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"15.5,0,2,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Оператор / эксперт\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"16\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text33\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"17.5,0,0.6,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Кол-во томов\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            },\\n            \\\"17\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text35\\\",\\n              \\\"CanGrow\\\": true,\\n              \\\"ClientRectangle\\\": \\\"18.1,0,0.7,0.3\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"Риск нарушения\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"Font\\\": \\\";;Bold;\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"Expression\\\"\\n            }\\n          },\\n          \\\"PrintIfEmpty\\\": true\\n        },\\n        \\\"2\\\": {\\n          \\\"Ident\\\": \\\"StiDataBand\\\",\\n          \\\"Name\\\": \\\"DataВК_Инвестора\\\",\\n          \\\"ClientRectangle\\\": \\\"0,3.3,18.92,0.4\\\",\\n          \\\"Interaction\\\": {\\n            \\\"Ident\\\": \\\"StiBandInteraction\\\"\\n          },\\n          \\\"Border\\\": \\\"Bottom;216,216,216;;;;;;solid:Black\\\",\\n          \\\"Brush\\\": \\\"solid:\\\",\\n          \\\"Components\\\": {\\n            \\\"0\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text1\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"0.3,0,0.9,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Код_Инвестпроекта}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"1\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text2\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"1.2,0,0.4,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Номер_этапа_проектирования}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"2\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text3\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"1.6,0,1.5,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Наименование_Агента_Заказчика}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"3\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text8\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"5.9,0,1.5,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Наименование_Агента_Заказчика}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"4\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text10\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"7.4,0,1.5,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Генеральный_проектировщик_ПД}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"5\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text12\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"8.9,0,1.3,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Филиал_ООО__Газпром_инвест_}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"6\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text14\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"3.1,0,0.9,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Версия_представления}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"7\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text15\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"0,0,0.3,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{Line}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"Type\\\": \\\"SystemVariables\\\"\\n            },\\n            \\\"8\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text18\\\",\\n              \\\"CanShrink\\\": true,\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"4,0,1.9,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Наименование_Инвестпроекта}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"9\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text19\\\",\\n              \\\"ClientRectangle\\\": \\\"10.2,0,1.4,0.4\\\",\\n              \\\"Conditions\\\": {\\n                \\\"0\\\": {\\n                  \\\"Ident\\\": \\\"StiCondition\\\",\\n                  \\\"Condition\\\": \\\"Containing\\\",\\n                  \\\"Column\\\": \\\"ВК_Инвестора.Статус_документации\\\",\\n                  \\\"Value1\\\": \\\"ПД. Входной контроль Инвестора: Согласовано\\\",\\n                  \\\"TextColor\\\": \\\"0,0,0\\\",\\n                  \\\"BackColor\\\": \\\"146,208,80\\\",\\n                  \\\"BorderSides\\\": \\\"None\\\"\\n                },\\n                \\\"1\\\": {\\n                  \\\"Ident\\\": \\\"StiCondition\\\",\\n                  \\\"Condition\\\": \\\"Containing\\\",\\n                  \\\"Column\\\": \\\"ВК_Инвестора.Статус_документации\\\",\\n                  \\\"Value1\\\": \\\"ПД. Входной контроль Инвестора: Отклонено\\\",\\n                  \\\"TextColor\\\": \\\"0,0,0\\\",\\n                  \\\"BackColor\\\": \\\"255,10,10\\\",\\n                  \\\"BorderSides\\\": \\\"None\\\"\\n                },\\n                \\\"2\\\": {\\n                  \\\"Ident\\\": \\\"StiCondition\\\",\\n                  \\\"Condition\\\": \\\"Containing\\\",\\n                  \\\"Column\\\": \\\"ВК_Инвестора.Статус_документации\\\",\\n                  \\\"Value1\\\": \\\"ПД. Входной контроль Инвестора: В работе\\\",\\n                  \\\"TextColor\\\": \\\"0,0,0\\\",\\n                  \\\"BackColor\\\": \\\"0,176,240\\\",\\n                  \\\"BorderSides\\\": \\\"None\\\"\\n                }\\n              },\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Статус_документации}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"10\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text21\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"11.6,0,0.6,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Номер_итерации}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"11\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text23\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"12.2,0,1.1,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Начало_ВК_Инвестора__факт_}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"12\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text27\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"13.3,0,1.1,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Окончание_ВК_Инвестора__план_}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"13\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text30\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"15.5,0,2,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Оператор___эксперт}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"14\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text34\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"18.1,0,0.7,0.4\\\",\\n              \\\"Conditions\\\": {\\n                \\\"0\\\": {\\n                  \\\"Ident\\\": \\\"StiMultiCondition\\\",\\n                  \\\"BackColor\\\": \\\"Red\\\",\\n                  \\\"BorderSides\\\": \\\"None\\\",\\n                  \\\"Filters\\\": {\\n                    \\\"0\\\": {\\n                      \\\"Ident\\\": \\\"StiFilter\\\",\\n                      \\\"Condition\\\": \\\"IsNull\\\",\\n                      \\\"Column\\\": \\\"ВК_Инвестора.Окончание_ВК_Инвестора__факт_\\\"\\n                    },\\n                    \\\"1\\\": {\\n                      \\\"Ident\\\": \\\"StiFilter\\\",\\n                      \\\"Item\\\": \\\"Expression\\\",\\n                      \\\"Expression\\\": {\\n                        \\\"Value\\\": \\\"{ВК_Инвестора.Окончание_ВК_Инвестора__план_ == Format(\\\\\\\"{0:dd.MM.yyyy}\\\\\\\", Today)}\\\"\\n                      }\\n                    }\\n                  }\\n                }\\n              },\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Риск_нарушения}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              },\\n              \\\"TextFormat\\\": {\\n                \\\"Ident\\\": \\\"StiDateFormatService\\\",\\n                \\\"StringFormat\\\": \\\"dd.MM.yy\\\"\\n              }\\n            },\\n            \\\"15\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text25\\\",\\n              \\\"GrowToHeight\\\": true,\\n              \\\"ClientRectangle\\\": \\\"14.4,0,1.1,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Окончание_ВК_Инвестора__факт_}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\",\\n              \\\"TextOptions\\\": {\\n                \\\"WordWrap\\\": true\\n              }\\n            },\\n            \\\"16\\\": {\\n              \\\"Ident\\\": \\\"StiText\\\",\\n              \\\"Name\\\": \\\"Text32\\\",\\n              \\\"ClientRectangle\\\": \\\"17.5,-0.01,0.6,0.4\\\",\\n              \\\"Interaction\\\": {\\n                \\\"Ident\\\": \\\"StiInteraction\\\"\\n              },\\n              \\\"Text\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.Кол_во_томов_в_процессах.Кол_во_томов}\\\"\\n              },\\n              \\\"HorAlignment\\\": \\\"Center\\\",\\n              \\\"VertAlignment\\\": \\\"Center\\\",\\n              \\\"Border\\\": \\\";;;;;;;solid:Black\\\",\\n              \\\"Brush\\\": \\\"solid:\\\",\\n              \\\"TextBrush\\\": \\\"solid:Black\\\"\\n            }\\n          },\\n          \\\"DataSourceName\\\": \\\"ВК Инвестора\\\",\\n          \\\"Sort\\\": {\\n            \\\"0\\\": \\\"ASC\\\",\\n            \\\"1\\\": \\\"Код_Инвестпроекта\\\",\\n            \\\"2\\\": \\\"ASC\\\",\\n            \\\"3\\\": \\\"Номер_этапа_проектирования\\\",\\n            \\\"4\\\": \\\"ASC\\\",\\n            \\\"5\\\": \\\"Версия_представления\\\",\\n            \\\"6\\\": \\\"ASC\\\",\\n            \\\"7\\\": \\\"ProjectId\\\"\\n          },\\n          \\\"Filters\\\": {\\n            \\\"0\\\": {\\n              \\\"Ident\\\": \\\"StiFilter\\\",\\n              \\\"Item\\\": \\\"Expression\\\",\\n              \\\"Expression\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.ModifiedDate <= EndDate.AddDays(1)}\\\"\\n              }\\n            },\\n            \\\"1\\\": {\\n              \\\"Ident\\\": \\\"StiFilter\\\",\\n              \\\"Item\\\": \\\"Expression\\\",\\n              \\\"Expression\\\": {\\n                \\\"Value\\\": \\\"{ВК_Инвестора.ModifiedDate >= StartDate}\\\"\\n              }\\n            }\\n          }\\n        }\\n      },\\n      \\\"PaperSize\\\": \\\"Letter\\\",\\n      \\\"Orientation\\\": \\\"Landscape\\\",\\n      \\\"PageWidth\\\": 19.7,\\n      \\\"PageHeight\\\": 8.5,\\n      \\\"Watermark\\\": {\\n        \\\"TextBrush\\\": \\\"solid:50,0,0,0\\\"\\n      },\\n      \\\"Margins\\\": {\\n        \\\"Left\\\": 0.39,\\n        \\\"Right\\\": 0.39,\\n        \\\"Top\\\": 0.39,\\n        \\\"Bottom\\\": 0.39\\n      }\\n    }\\n  }\\n}\"\r\n}"
        

        template_name:str = "Отчет по Входному контролю Инвестора"
        try:
            self.__logger.info(self.__start_connection(url))
            response = requests.post(url=f"{url}/{self.__api_Reports_Template}", headers=headers, data=payload.encode('utf-8'), verify=False)
            self.__logger.debug(self.__check_response(url, response.request.method, response.request.path_url, response.status_code))
            if response.status_code == 201:
                print(f"Report template successfully uploaded!\nName: {template_name}")
        except self.possible_request_errors as err:
            self.__logger.error(err)
            return False
        except KeyboardInterrupt:
            print('\nInterrupted by the user.')
            return False        